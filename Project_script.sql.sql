DROP MATERIALIZED VIEW IF EXISTS ORDERED_PRODUCTS;
DROP TABLE IF EXISTS ADDED;
DROP TABLE IF EXISTS BELONGS;
DROP TABLE IF EXISTS PAYMENT;
DROP TABLE IF EXISTS SHIPPING;
DROP TABLE IF EXISTS ORDERDATA;
DROP TABLE IF EXISTS CART;
DROP TABLE IF EXISTS PRODUCT;
DROP TABLE IF EXISTS PRICE;
DROP TABLE IF EXISTS PERSONAL_INFO;
DROP TABLE IF EXISTS CATEGORY;
DROP TABLE IF EXISTS ADMIN_;
DROP TABLE IF EXISTS BRAND;
DROP TABLE IF EXISTS USER_;


CREATE TABLE USER_(
	USER_ID INTEGER PRIMARY KEY,
	USER_NAME VARCHAR(150) NOT NULL,
	USER_EMAIL VARCHAR(200) NOT NULL,
	USER_LOGIN VARCHAR(150) NOT NULL,
	USER_PASSWORD VARCHAR(150) NOT NULL,
	CARD_NUMBER VARCHAR(16) NOT NULL
);

INSERT INTO USER_ VALUES (1, 'Esfira', 'esfira@gmail.com', 'Esfira2002', 'testPass', '0000000000000000');
INSERT INTO USER_ VALUES (2, 'Lilit', 'lilit@gmail.com', 'Lilit02', 'Lilit2022', '1234123412341234');
INSERT INTO USER_ VALUES (3, 'Mane', 'mane@gmail.com', 'Mane01', 'Mane2001', '378282246310005');
INSERT INTO USER_ VALUES (4, 'William', 'william@gmail.com', 'Will', 'pAssWorD', '371449635398431');
INSERT INTO USER_ VALUES (5, 'Michael', 'michael@gmail.com', 'Mike', '123pass456', '378734493671000');
INSERT INTO USER_ VALUES (6, 'Lora', 'lora@gmail.com', 'Lora_22', 'lorasPass', '30569309025904');
INSERT INTO USER_ VALUES (7, 'Frank', 'frank@gmail.com', 'Frank Medison', 'FrMed980', '6011111111111117');
INSERT INTO USER_ VALUES (8, 'George', 'george@gmail.com', 'George06', 'GeorgeShopper3', '6011000990139424');
INSERT INTO USER_ VALUES (9, 'Jessica', 'jessica@gmail.com', 'Jess21', 'shopPass', '3530111333300000');
INSERT INTO USER_ VALUES (10, 'Charlotte', 'charlotte@gmail.com', 'Charlotte', 'shopaholic76', '2221000000000009');
INSERT INTO USER_ VALUES (11, 'David', 'david@gmail.com', 'Dave', 'SeCuRepaSS', '3566002020360505');
INSERT INTO USER_ VALUES (12, 'Anahit', 'anahit@gmail.com', 'Anahit37', 'mypassword2021', '2223000048400011');
INSERT INTO USER_ VALUES (13, 'Natali', 'natali@gmail.com', 'Nata', 'Natasha23', '4012888888881881');
INSERT INTO USER_ VALUES (14, 'Margarita', 'margarita@gmail.com', 'Maga', 'MgMg03', '2223016768739313');
INSERT INTO USER_ VALUES (15, 'Lilit', 'lilit2001@gmail.com', 'Lilit', 'Lil2001', '5555555555554444');



CREATE TABLE BRAND(
	BRAND_ID INTEGER PRIMARY KEY,
	BRAND_NAME VARCHAR(100) NOT NULL,
	BRAND_WAREHOUSE_LOC VARCHAR(250)
);

INSERT INTO BRAND VALUES(1, 'Adidas', 'Aram Street');
INSERT INTO BRAND VALUES(2, 'Nike', 'Hanrapetutyun Street');
INSERT INTO BRAND VALUES(3, 'Rebook', 'Union Square');
INSERT INTO BRAND VALUES(4, 'Calvin Klein', 'Regent Street');
INSERT INTO BRAND VALUES(5, 'Michael Kors', 'Prince Street');
INSERT INTO BRAND VALUES(6, 'Celio', 'Arshakunyats Highway');
INSERT INTO BRAND VALUES(7, 'Tommy Hilfiger', 'Northern Avenue');
INSERT INTO BRAND VALUES(8, 'Fila', 'Washington Street');
INSERT INTO BRAND VALUES(9, 'Zara', 'C. de la Princesa');
INSERT INTO BRAND VALUES(10, 'Massimo Dutti', '689 5th Avenue');
INSERT INTO BRAND VALUES(11, 'Accessorize', 'Oxford Street');
INSERT INTO BRAND VALUES(12, 'Victorias Secret', 'New Bond Street');
INSERT INTO BRAND VALUES(13, 'Coach', '845 Market St');
INSERT INTO BRAND VALUES(14, 'Guess', 'Papazyan Street');
INSERT INTO BRAND VALUES(15, 'Karl Lagerfeld', 'Regent Street');
INSERT INTO BRAND VALUES(16, 'Levis', 'Santa Monica Blvd');



CREATE TABLE ADMIN_(
	ADMIN_ID INTEGER NOT NULL PRIMARY KEY,
	ADMIN_NAME VARCHAR(100) NOT NULL,
	ADMIN_PASS VARCHAR(100) NOT NULL
);

INSERT INTO ADMIN_ VALUES (1, 'Vanessa Nelson', 'adm245V.');
INSERT INTO ADMIN_ VALUES (2, 'Robin Williams', 'R1029w1988');
INSERT INTO ADMIN_ VALUES (3, 'James Smith', 'Js805*admin');
INSERT INTO ADMIN_ VALUES (4, 'Arina Kasparian', 'Ak53vTx9Ye');
INSERT INTO ADMIN_ VALUES (5, 'Harry Miller', 'M*h2709Y.');
INSERT INTO ADMIN_ VALUES (6, 'Alex Harris', 'AHarr357/.s');
INSERT INTO ADMIN_ VALUES (7, 'Selene Lopez', '58s27Lp4*');
INSERT INTO ADMIN_ VALUES (8, 'Anna Parker', 'a369nn28.');
INSERT INTO ADMIN_ VALUES (9, 'Areg Grigorian', 'Gr857aR.E');
INSERT INTO ADMIN_ VALUES (10, 'Andrew Harper', 'bh2e45.Ad');
INSERT INTO ADMIN_ VALUES (11, 'Michael Saroyan', 'S65adminn.M98');
INSERT INTO ADMIN_ VALUES (12, 'Lily Morris', 'LmoRr7856.*');

	
CREATE TABLE CATEGORY(
	CATEGORY_ID INTEGER PRIMARY KEY,
	CATEGORY_NAME VARCHAR(100) NOT NULL,
	CATEGORY_DESCRIPTION VARCHAR(300)
);

INSERT INTO CATEGORY VALUES (1, 'Sweatshirts', 'Warm and comfortable sweatshirts, sweaters, hoodies, etc.');
INSERT INTO CATEGORY VALUES (2, 'T-shirts', 'Sporty, classic, casual shirts');
INSERT INTO CATEGORY VALUES (3, 'Dresses', 'Classic, casual, sporty, evening dresses.');
INSERT INTO CATEGORY VALUES (4, 'Pants', 'Jeans, sweatpants, casual pants.');
INSERT INTO CATEGORY VALUES (5, 'Sneakers', 'Athletic and casual footwear.');
INSERT INTO CATEGORY VALUES (6, 'Shoes', 'Casual, boots, classic, heels, sandals, etc.');
INSERT INTO CATEGORY VALUES (7, 'Bags', 'Backpacks, handbags, luggage, wallets, etc.');
INSERT INTO CATEGORY VALUES (8, 'Accessories', 'Necklaces, bracelets, anklets, rings, etc.');
INSERT INTO CATEGORY VALUES (9, 'Sleepwear', 'Pyjamas in different styles.');
INSERT INTO CATEGORY VALUES (10, 'Swimwear', 'Swimsuits, slippers, etc.');

CREATE TABLE PERSONAL_INFO(
	PERSONAL_ID INTEGER PRIMARY KEY,
	COUNTRY VARCHAR(100) NOT NULL,
	CITY VARCHAR(100) NOT NULL,
	POSTAL_CODE VARCHAR(10) NOT NULL,
	ADDRESS VARCHAR(300) NOT NULL,
	BIRTH_DATE DATE NOT NULL,
	USER_ID INTEGER REFERENCES USER_(USER_ID) ON DELETE CASCADE
);

INSERT INTO PERSONAL_INFO VALUES(1, 'Armenia', 'Yerevan', '0002','33 Tumanyan Str.', '2002-2-01', 1);
INSERT INTO PERSONAL_INFO VALUES(2, 'Armenia', 'Yerevan', '0002','38 Mashtots Ave','2000-5-28', 2);
INSERT INTO PERSONAL_INFO VALUES(3, 'Armenia', 'Yerevan', '0002','9 Martiros Saryan Str.','2001-8-12', 3);
INSERT INTO PERSONAL_INFO VALUES(4, 'United States', 'Michigan', '48174','King Road','2003-9-17', 4);
INSERT INTO PERSONAL_INFO VALUES(5, 'Germany', 'Munich', '81679','Holbeinstraße','1996-10-1', 5);
INSERT INTO PERSONAL_INFO VALUES(6, 'United States', 'California', '90211','19 Arcadia Ave','1994-6-8', 6);
INSERT INTO PERSONAL_INFO VALUES(7, 'United Kingdom', 'London', '5211','5 Church Lane','1998-8-4', 7);
INSERT INTO PERSONAL_INFO VALUES(8, 'France', 'Paris', '75014','13 rue La Boétie','2002-12-11', 8);
INSERT INTO PERSONAL_INFO VALUES(9, 'Italy', 'Milan', '002','Via Mambretti','2002-3-29', 9);
INSERT INTO PERSONAL_INFO VALUES(10, 'Spain', 'Valencia', '46852','Carrer de Puerto Rico, 62','1976-8-20', 10);
INSERT INTO PERSONAL_INFO VALUES(11, 'United Kingdom', 'Bristol', 'BS8 4TW','Clifton Wood Rd','2004-1-16', 11);
INSERT INTO PERSONAL_INFO VALUES(12, 'Armenia', 'Gyumri', '3104','17 Abovyan Str.', '2002-11-15',12);
INSERT INTO PERSONAL_INFO VALUES(13, 'France', 'Le Bouscat', '33110','56 boulevard Aristide Briand','2002-6-13', 13);
INSERT INTO PERSONAL_INFO VALUES(14, 'Russia', 'Moscow', '187051','New Arbat Ave, 93','1993-7-14', 14);
INSERT INTO PERSONAL_INFO VALUES(15, 'Armenia', 'Kapan', '3304','Aram Manukyan Str.','2002-3-27', 15);


CREATE TABLE PRICE(
	PRICE_ID INTEGER PRIMARY KEY,
	PRICE_VALUE NUMERIC(15,3) NOT NULL,
	CURRENCY VARCHAR(50) NOT NULL,
	SALES_PERCENT NUMERIC(6,2),
	SALES_EXP_DATE VARCHAR(10)
);


INSERT INTO PRICE VALUES (1, 300.0, 'USD');
INSERT INTO PRICE VALUES (2, 15.0, 'USD');
INSERT INTO PRICE VALUES (3, 40000.0, 'AMD', 20.0, '2022-5-26');
INSERT INTO PRICE VALUES (4, 300.0, 'USD');
INSERT INTO PRICE VALUES (5, 2841.59 , 'RUB');
INSERT INTO PRICE VALUES (6, 204.88, 'GBP', 15.0, '2022-5-27');
INSERT INTO PRICE VALUES (7, 100.0, 'EUR');
INSERT INTO PRICE VALUES (8, 50, 'EUR');
INSERT INTO PRICE VALUES (9, 700.0, 'USD');
INSERT INTO PRICE VALUES (10, 20.5, 'GBP');
INSERT INTO PRICE VALUES (11, 70, 'EUR', 30.0, '2022-5-20');
INSERT INTO PRICE VALUES (12, 18.94, 'USD');
INSERT INTO PRICE VALUES (13, 35000.0, 'AMD');
INSERT INTO PRICE VALUES (14, 130.0, 'EUR');
INSERT INTO PRICE VALUES (15, 433.80, 'GBP');


CREATE TABLE PRODUCT(
	PRODUCT_ID INTEGER PRIMARY KEY,
	PRODUCT_NAME VARCHAR(100) NOT NULL,
	PRODUCT_DESCRIPTION VARCHAR(500),
	PRODUCT_QUANTITY INTEGER,
	PRODUCT_SIZE VARCHAR(50) NOT NULL,
	PRODUCT_WEIGHT VARCHAR(50),
	PRODUCT_IMAGE VARCHAR(50) NOT NULL,
	BRAND_ID INTEGER REFERENCES BRAND(BRAND_ID) ON DELETE CASCADE,
	ADMIN_ID INTEGER REFERENCES ADMIN_(ADMIN_ID) ON DELETE CASCADE,
	PRICE_ID INTEGER REFERENCES PRICE(PRICE_ID) ON DELETE CASCADE
);

INSERT INTO PRODUCT VALUES (1, 'Prom Dress', 'Blue color, silk.', 5, 'S, M, L', NULL, 'prom_dress.jpg', 14, 4, 1);
INSERT INTO PRODUCT VALUES (2, 'Travelling bag', 'Synthetic material. Holds up to 8 kg.', 4, '50x30x20 cm', '0.5 kg', 'travel_bag.jpg', 8, 10, 3);
INSERT INTO PRODUCT VALUES (3, 'Sporty shirt', 'Short-sleeve shirt, 100% cotton, perfect for sport activities.', 3, 'XS, S, M, XL', '20 g', 'spshirt.jpg', 4, 3, 2);
INSERT INTO PRODUCT VALUES (4, 'Winter boots', 'Warm leather boots for extremely cold weather.', 2, '38, 39, 41', '1.5 kg', 'boots.jpg', 16, 6, 6);
INSERT INTO PRODUCT VALUES (5, 'Sweat-set', 'Grey sweatshirt and the matching sweatpants.', 6, 'S, M, L, XL, 2XL', '0.9 kg', 'sweatset.jpg', 9, 8, 8);
INSERT INTO PRODUCT VALUES (6, 'Comfy PJs', '100% cotton, long-sleeve pyjamas.', 2, 'M', NULL, 'pjs.jpg', 12, 12, 10);
INSERT INTO PRODUCT VALUES (7, 'Air Force 1', 'NIKE Air Force 1 | white, black', 4, '38, 38.5, 39, 40', '0.9 kg', 'AF1.jpg', 2, 9, 7);
INSERT INTO PRODUCT VALUES (8, 'Casual jeans', 'Low-waist mom jeans.', 3, 'M, L', NULL, 'jeans.jpg', 7, 4, 11);
INSERT INTO PRODUCT VALUES (9, 'Red swimsuit', NULL, 3, 'S, M', NULL, 'red_swimsuit.jpg', 6, 7, 14);
INSERT INTO PRODUCT VALUES (10, 'Silver bracelet', 'Casual shiny silver bracelet.', 2, '17 cm', NULL, 'bracelet.jpg', 11, 1, 13);
INSERT INTO PRODUCT VALUES (11, 'White sweather', 'Cotton and synthetic material.', 1, 'L', '0.8 kg', 'whitesw.jpg', 10, 5, 8);
INSERT INTO PRODUCT VALUES (12, 'Tank top', 'Cotton, short-sleeve shirt.', 2, 'S', NULL, 'tanktop.jpg', 1, 6, 12);
INSERT INTO PRODUCT VALUES (13, 'Leggings', 'Synthetic material. Athletic pants.', 4, 'S, L, XL', NULL, 'legg.jpg', 3, 4, 2);
INSERT INTO PRODUCT VALUES (14, 'Handbag', NULL, 5, '35x40x15 cm', '0.4 kg', 'handbg.jpg', 13, 11, 11);
INSERT INTO PRODUCT VALUES (15, 'Jacket', '100% cotton, warm, oversized.', 3, 'L, XL, 2XL', '0.3 kg', 'jacket.jpg', 15, 8, 3);


CREATE TABLE CART(
    CART_ID INTEGER PRIMARY KEY,
	TOTAL_PRICE NUMERIC(8,3),
    NUMBER_OF_PRODUCTS INTEGER
);

INSERT INTO CART VALUES (1);
INSERT INTO CART VALUES (2, 120, 2);
INSERT INTO CART VALUES (3, 120, 1);
INSERT INTO CART VALUES (4, 1200, 2);
INSERT INTO CART VALUES (5, 3000, 1);
INSERT INTO CART VALUES (6, 135, 2);
INSERT INTO CART VALUES (7, 65, 1);
INSERT INTO CART VALUES (8, 120, 4);
INSERT INTO CART VALUES (9, 650, 4);
INSERT INTO CART VALUES (10, 500, 3);
INSERT INTO CART VALUES (11, 25.50, 1);
INSERT INTO CART VALUES (12, 500, 2);
INSERT INTO CART VALUES (13);
INSERT INTO CART VALUES (14, 160, 1);
INSERT INTO CART VALUES (15, 536.22, 2);


CREATE TABLE ORDERDATA (
    ORDER_ID INTEGER PRIMARY KEY,
	USER_ID INTEGER REFERENCES USER_(USER_ID) ON DELETE CASCADE,
	CART_ID INTEGER REFERENCES CART(CART_ID) ON DELETE CASCADE
);

INSERT INTO ORDERDATA VALUES (1, 2, 4);
INSERT INTO ORDERDATA VALUES (2, 2, 2);
INSERT INTO ORDERDATA VALUES (3, 15, 3);
INSERT INTO ORDERDATA VALUES (4, 13, 1);
INSERT INTO ORDERDATA VALUES (5, 14, 2);
INSERT INTO ORDERDATA VALUES (6, 9, 9);
INSERT INTO ORDERDATA VALUES (7,  12, 1);
INSERT INTO ORDERDATA VALUES (8, 4, 8);
INSERT INTO ORDERDATA VALUES (9, 12, 13);
INSERT INTO ORDERDATA VALUES (10, 11, 7);
INSERT INTO ORDERDATA VALUES (11, 10, 14);
INSERT INTO ORDERDATA VALUES (12, 2, 2);
INSERT INTO ORDERDATA VALUES (13, 15, 5);
INSERT INTO ORDERDATA VALUES (14,  3, 6);
INSERT INTO ORDERDATA VALUES (15, 1, 15);


CREATE TABLE SHIPPING(
	SHIPPING_ID NUMERIC(12) PRIMARY KEY,
	SHIPPING_STATUS VARCHAR(255),
	SUPPLIER_ADDRESS VARCHAR(100),
	ORDER_ID INTEGER REFERENCES ORDERDATA(ORDER_ID) ON DELETE CASCADE
);

INSERT INTO SHIPPING VALUES (1, 'Canceled', '24D Marshal Baghramyan Ave, Yerevan 0019', 4);
INSERT INTO SHIPPING VALUES (2, 'Ready to ship', 'BS8 4TW Clifton Wood Rd', 2);
INSERT INTO SHIPPING VALUES (3, 'Shipped', 'Woolwich Church Street, SE18 5ND', 3);
INSERT INTO SHIPPING VALUES (4, 'Shipped', '1 Yervand Kochar St, Yerevan', 1);
INSERT INTO SHIPPING VALUES (5, 'Ready to ship', '81679 Holbeinstraße', 5);
INSERT INTO SHIPPING VALUES (6, 'Canceled', 'Carrer de Puerto Rico 62, 46852', 7);
INSERT INTO SHIPPING VALUES (7,'Shipped', 'Bridge Street, 11201', 6);
INSERT INTO SHIPPING VALUES (8, 'Shipped', '6, apt. 99 Mesrop Mashtots Ave, Yerevan 0015', 8);
INSERT INTO SHIPPING VALUES (9, 'Canceled', '0019, 40 Marshal Baghramyan Ave, Yerevan 0019', 13);
INSERT INTO SHIPPING VALUES (10, 'Ready to ship', '44 Admiral Isakov Ave, Yerevan', 9);
INSERT INTO SHIPPING VALUES (11, 'Shipped', '2nd Floor, Room 3, 20 Marshal Baghramyan Ave, Yerevan 0019', 10);
INSERT INTO SHIPPING VALUES (12, 'Ready to ship', 'New Arbat Ave 93, 18705', 12);
INSERT INTO SHIPPING VALUES (13, 'Shipped', 'Via Mambretti, 002', 11);
INSERT INTO SHIPPING VALUES (14, 'Shipped', '1 Mazmanian St, Yerevan 0088', 14);
INSERT INTO SHIPPING VALUES (15, 'Canceled', '44 Admiral Isakov Ave, Yerevan', 15);


CREATE TABLE PAYMENT (
    PAYMENT_ID INTEGER PRIMARY KEY,
    PAYMENT_METHOD VARCHAR(50) NOT NULL,
    CARD_EXP_DATE DATE NOT NULL,
    BILLING_ADDRESS VARCHAR(255) NOT NULL,
    PAYMENT_STATUS VARCHAR(50) NOT NULL,
	ORDER_ID INTEGER NOT NULL REFERENCES ORDERDATA(ORDER_ID) ON DELETE CASCADE
);

INSERT INTO PAYMENT VALUES (1, 'MasterCard', TO_DATE ('12-27', 'MM-YY'), '30 Fuchik St, Yerevan 0048, Armenia', 'Payment Complete', 1);
INSERT INTO PAYMENT VALUES (2, 'GiftCard', TO_DATE ('09-22', 'MM-YY'), '16 Halabyan St, Yerevan 0038, Armenia', 'Payment Complete', 2);
INSERT INTO PAYMENT VALUES (3, 'VISA', TO_DATE ('10-23', 'MM-YY'),'6 Abelian St, Yerevan 0038, Armenia', 'Payment Complete', 3);
INSERT INTO PAYMENT VALUES (4, 'VISA', TO_DATE ('03-24', 'MM-YY'), '40 Moskovyan Street, Yerevan 0002, Armenia', 'Payment Complete', 4);
INSERT INTO PAYMENT VALUES (5, 'MasterCard', TO_DATE ('06-22', 'MM-YY'), '90 Sarmen St, Yerevan 0019, Armenia', 'Payment Complete', 5);
INSERT INTO PAYMENT VALUES (6, 'MasterCard', TO_DATE ('04-25', 'MM-YY'), '10 Vagharsh Vagharshyan St, Yerevan 0012, Armenia', 'Payment Complete', 6);
INSERT INTO PAYMENT VALUES (7, 'MasterCard', TO_DATE ('04-25', 'MM-YY'), '10 Vagharsh Vagharshyan St, Yerevan 0012, Armenia', 'Payment Complete', 7);
INSERT INTO PAYMENT VALUES (8, 'VISA', TO_DATE ('03-24', 'MM-YY'), '8 Vahram Papazyan St, Yerevan 0012, Armenia', 'Pending', 8);
INSERT INTO PAYMENT VALUES (9, 'MasterCard', TO_DATE ('03-25', 'MM-YY'), '40/1 Komitas Ave, Yerevan 0051, Armenia', 'Pending', 9);
INSERT INTO PAYMENT VALUES (10, 'VISA', TO_DATE ('09-27', 'MM-YY'), '8 Vahram Papazyan St, Yerevan 0012, Armenia', 'Payment Complete', 10);
INSERT INTO PAYMENT VALUES (11, 'VISA', TO_DATE ('02-22', 'MM-YY'), '9 Vahram Papazyan St, Yerevan 0012, Armenia', 'Payment Complete', 11);
INSERT INTO PAYMENT VALUES (12, 'MasterCard', TO_DATE ('12-21', 'MM-YY'), '15, 5 Rubinyants St, Yerevan, Armenia', 'Pending', 12);
INSERT INTO PAYMENT VALUES (13, 'VISA', TO_DATE ('01-21', 'MM-YY'), '1, Boryan Street, Yerevan 0056, Armenia', 'Payment Complete', 13);
INSERT INTO PAYMENT VALUES (14, 'MasterCard', TO_DATE ('02-28', 'MM-YY'),  '32 Myasnikyan Ave, Yerevan, Armenia', 'Pending', 14);
INSERT INTO PAYMENT VALUES (15, 'MasterCard', TO_DATE ('11-22', 'MM-YY'), '16 Gai Ave, Yerevan, Armenia', 'Pending', 15);


CREATE TABLE BELONGS(
	CATEGORY_ID INTEGER REFERENCES CATEGORY(CATEGORY_ID),
	PRODUCT_ID INTEGER REFERENCES PRODUCT(PRODUCT_ID),
	PRIMARY KEY (CATEGORY_ID, PRODUCT_ID)	
);

INSERT INTO BELONGS VALUES (1, 5);
INSERT INTO BELONGS VALUES (1, 11);
INSERT INTO BELONGS VALUES (1, 15);
INSERT INTO BELONGS VALUES (2, 3);
INSERT INTO BELONGS VALUES (2, 12);
INSERT INTO BELONGS VALUES (3, 1);
INSERT INTO BELONGS VALUES (4, 5);
INSERT INTO BELONGS VALUES (4, 8);
INSERT INTO BELONGS VALUES (4, 13);
INSERT INTO BELONGS VALUES (5, 7);
INSERT INTO BELONGS VALUES (6, 4);
INSERT INTO BELONGS VALUES (7, 2);
INSERT INTO BELONGS VALUES (7, 14);
INSERT INTO BELONGS VALUES (8, 10);
INSERT INTO BELONGS VALUES (9, 6);
INSERT INTO BELONGS VALUES (10, 9);


CREATE TABLE ADDED(
	CART_ID INTEGER REFERENCES CART(CART_ID),
	PRODUCT_ID INTEGER REFERENCES PRODUCT(PRODUCT_ID),
	PRIMARY KEY (CART_ID, PRODUCT_ID)
);

INSERT INTO ADDED VALUES(2,1);
INSERT INTO ADDED VALUES(3,4);
INSERT INTO ADDED VALUES(4,5);
INSERT INTO ADDED VALUES(5,6);
INSERT INTO ADDED VALUES(6,7);
INSERT INTO ADDED VALUES(7,9);
INSERT INTO ADDED VALUES(8,5);
INSERT INTO ADDED VALUES(9,2);
INSERT INTO ADDED VALUES(10,5);
INSERT INTO ADDED VALUES(11,4);
INSERT INTO ADDED VALUES(12,5);
INSERT INTO ADDED VALUES(14,6);
INSERT INTO ADDED VALUES(15,6);

--Queries
--updating the existing status pending to complete after the money transactions are complete
UPDATE PAYMENT SET PAYMENT_STATUS = 'Payment Complete' WHERE ORDER_ID = 15;

--this query can be used in the "detail" part of the product, it will give you all the information
--about the product such as brand, category, price, color...
SELECT PRODUCT.PRODUCT_NAME, PRODUCT.PRODUCT_DESCRIPTION, PRODUCT.PRODUCT_IMAGE,
PRICE.PRICE_VALUE,PRICE.CURRENCY, BRAND.BRAND_NAME
FROM PRODUCT 
INNER JOIN PRICE ON PRODUCT.PRICE_ID = PRICE.PRICE_ID 
INNER JOIN BELONGS ON BELONGS.PRODUCT_ID = PRODUCT.PRODUCT_ID
INNER JOIN CATEGORY ON BELONGS.CATEGORY_ID = CATEGORY.CATEGORY_ID
INNER JOIN BRAND ON PRODUCT.BRAND_ID = BRAND.BRAND_ID 
WHERE PRODUCT.PRODUCT_ID = 4;

--Create view from frequently used inner join statements
CREATE MATERIALIZED VIEW ORDERED_PRODUCTS
AS SELECT ORDERDATA.CART_ID, PRODUCT.PRODUCT_ID, PRODUCT.PRODUCT_NAME, ORDERDATA.USER_ID FROM ORDERDATA
INNER JOIN ADDED ON ORDERDATA.CART_ID = ADDED.CART_ID
INNER JOIN PRODUCT ON PRODUCT.PRODUCT_ID = ADDED.PRODUCT_ID;

--Will return the top 5 bestsellers
SELECT COUNT(PRODUCT_NAME), PRODUCT_NAME FROM ORDERED_PRODUCTS
GROUP BY PRODUCT_NAME
ORDER BY COUNT(PRODUCT_NAME) DESC
LIMIT 5;

--This query selects the products in the users carts grouped by product category
--Can be used for target advertising
SELECT USER_ID, COUNT(CATEGORY.CATEGORY_NAME), CATEGORY.CATEGORY_NAME FROM ORDERED_PRODUCTS
INNER JOIN BELONGS ON ORDERED_PRODUCTS.PRODUCT_ID = BELONGS.PRODUCT_ID
INNER JOIN CATEGORY ON CATEGORY.CATEGORY_ID = BELONGS.CATEGORY_ID
GROUP BY CATEGORY.CATEGORY_NAME, USER_ID
ORDER BY USER_ID DESC;

--With this query we will see where do we get most users from and find our target market.
--It will help us to streamline delivery operations in countries with high demand.
SELECT COUNT(PERSONAL_INFO.COUNTRY), PERSONAL_INFO.COUNTRY FROM ORDERDATA
INNER JOIN PERSONAL_INFO ON ORDERDATA.USER_ID = PERSONAL_INFO.USER_ID
GROUP BY COUNTRY
ORDER BY COUNT(COUNTRY) DESC;




